<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Alaman - –ü–æ–∏—Å–∫ –æ–±—ä—è–≤–ª–µ–Ω–∏–π</title>
    <style>
        body { font-family: 'Inter', sans-serif; background: #F2F4F7; display: flex; flex-direction: column; align-items: center; padding: 20px; }
        .app-card { background: white; border-radius: 24px; padding: 25px; box-shadow: 0 10px 30px rgba(0,0,0,0.08); width: 100%; max-width: 480px; }
        .input-group { margin-bottom: 20px; }
        .section-label { font-size: 11px; font-weight: 700; color: #667085; text-transform: uppercase; display: block; margin-bottom: 8px; }
        input, select { width: 100%; padding: 14px; border: 1.5px solid #EAECF0; border-radius: 12px; box-sizing: border-box; }
        .search-btn { background: #007AFF; color: white; width: 100%; padding: 18px; border: none; border-radius: 16px; font-weight: 700; cursor: pointer; }
        .tender-card { background: white; padding: 20px; border-radius: 18px; margin-top: 12px; border-left: 6px solid #12B76A; width: 100%; max-width: 480px; box-shadow: 0 4px 12px rgba(0,0,0,0.05); }
    </style>
</head>
<body>
    <div class="app-card">
        <h2 style="text-align:center">–ü–æ–∏—Å–∫ –æ–±—ä—è–≤–ª–µ–Ω–∏–π üîç</h2>
        <div class="input-group">
            <span class="section-label">–ú–µ—Å—Ç–æ –ø–æ—Å—Ç–∞–≤–∫–∏ (–ö–ê–¢–û)</span>
            <input type="text" id="cityInput" list="kato-list" value="–≥. –ö—ã–∑—ã–ª–ærda">
            <datalist id="kato-list">
                <option value="–≥. –ê—Å—Ç–∞–Ω–∞"><option value="–≥. –ê–ª–º–∞—Ç—ã"><option value="–≥. –ö–∞—Ä–∞–≥–∞–Ω–¥–∞"><option value="–≥. –ö—ã–∑—ã–ª–æ—Ä–¥–∞">
            </datalist>
        </div>
        <div class="input-group">
            <span class="section-label">–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ</span>
            <input type="text" id="searchInput" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: —Ä–µ–º–æ–Ω—Ç">
        </div>
        <div class="input-group">
            <span class="section-label">–°—Ç–∞—Ç—É—Å</span>
            <select id="statusSelect">
                <option value="350">–ó–∞–≤–µ—Ä—à–µ–Ω–æ</option>
                <option value="210">–û–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–æ</option>
            </select>
        </div>
        <button class="search-btn" onclick="fetchData()">–ü–æ–∫–∞–∑–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã</button>
    </div>
    <div id="results"></div>

    <script>
        async function fetchData() {
            const resultsDiv = document.getElementById('results');
            resultsDiv.innerHTML = "<p>–ü–æ–∏—Å–∫ –≤ Goszakup...</p>"; //
            
            const filters = {
                city: document.getElementById('cityInput').value,
                keyword: document.getElementById('searchInput').value,
                status: document.getElementById('statusSelect').value
            };

            try {
                // Tarayƒ±cƒ± √ºzerinden yerel IP adresine baƒülanmayƒ± deniyoruz
                const response = await fetch('http://127.0.0.1:5000/search', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify(filters)
                });
                const data = await response.json();
                
                resultsDiv.innerHTML = data.map(t => `
                    <div class="tender-card">
                        <div style="color:#027A48; font-weight:800; font-size:19px;">${t.price} ‚Ç∏</div>
                        <div style="font-size:14px; margin:8px 0; font-weight:600;">${t.title}</div>
                        <div style="font-size:12px; color:gray;">‚Ññ: ${t.no} | –°—Ç–∞—Ç—É—Å: ${t.status}</div>
                    </div>`).join('');
            } catch (e) {
                // Baƒülantƒ± hatasƒ± durumunda kullanƒ±cƒ±ya rehberlik eder
                resultsDiv.innerHTML = "<p style='color:red; text-align:center;'>–û—à–∏–±–∫–∞: –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –æ—Ç–∫—Ä–æ–π—Ç–µ <b>http://127.0.0.1:5000</b> yeni bir sekmede a√ßƒ±p 'Geli≈ümi≈ü -> Siteye Git' diyerek izin verin.</p>";
            }
        }
    </script>
</body>
</html>
