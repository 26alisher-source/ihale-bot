<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Alaman - Global Search</title>
    <style>
        body { font-family: 'Segoe UI', sans-serif; background: #f0f2f5; padding: 20px; }
        .container { max-width: 600px; margin: auto; background: white; padding: 30px; border-radius: 20px; box-shadow: 0 10px 25px rgba(0,0,0,0.1); }
        select, input { width: 100%; padding: 12px; margin: 10px 0; border: 1px solid #ddd; border-radius: 10px; }
        button { width: 100%; padding: 15px; background: #007bff; color: white; border: none; border-radius: 12px; font-weight: bold; cursor: pointer; font-size: 16px; }
        .tender-card { background: #fff; border-left: 6px solid #28a745; margin-top: 15px; padding: 15px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.05); }
    </style>
</head>
<body>
    <div class="container">
        <h2>üîç T√ºm Kazakistan ƒ∞hale Aramasƒ±</h2>
        
        <label>–ú–µ—Å—Ç–æ –ø–æ—Å—Ç–∞–≤–∫–∏ (KATO Kodu veya ≈ûehir):</label>
        <input type="text" id="katoInput" placeholder="√ñrn: 431010000 (Kyzylorda)" value="">
        
        <label>–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ (Anahtar Kelime):</label>
        <input type="text" id="keywordInput" placeholder="√ñrn: —Ä–µ–º–æ–Ω—Ç">
        
        <label>–°—Ç–∞—Ç—É—Å (Durum):</label>
        <select id="statusSelect">
            <option value="">–í—Å–µ —Å—Ç–∞—Ç—É—Å—ã</option>
            <option value="210">–û–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–æ</option>
            <option value="350">–ó–∞–≤–µ—Ä—à–µ–Ω–æ</option>
        </select>

        <label>–°–ø–æ—Å–æ–± –∑–∞–∫—É–ø–∫–∏ (ƒ∞hale Y√∂ntemi):</label>
        <select id="methodSelect">
            <option value="">–í—Å–µ –º–µ—Ç–æ–¥—ã</option>
            <option value="2">–ó–∞–ø—Ä–æ—Å —Ü–µ–Ω–æ–≤—ã—Ö –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π</option>
            <option value="1">–û—Ç–∫—Ä—ã—Ç—ã–π –∫–æ–Ω–∫—É—Ä—Å</option>
            <option value="5">–ò–∑ –æ–¥–Ω–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞</option>
        </select>
        
        <button onclick="globalSearch()">–ü–æ–∏—Å–∫ –ø–æ –≤—Å–µ–º—É –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω—É</button>
    </div>
    <div id="resultsList" style="max-width:600px; margin:auto;"></div>

    <script>
        async function globalSearch() {
            const resultsDiv = document.getElementById('resultsList');
            resultsDiv.innerHTML = "<p style='text-align:center'>–ó–∞–≥—Ä—É–∑–∫–∞...</p>";
            
            const payload = {
                kato: document.getElementById('katoInput').value,
                keyword: document.getElementById('keywordInput').value,
                status: document.getElementById('statusSelect').value,
                method: document.getElementById('methodSelect').value
            };

            try {
                const response = await fetch('http://127.0.0.1:5000/search', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify(payload)
                });
                const data = await response.json();
                resultsDiv.innerHTML = data.map(t => `
                    <div class="tender-card">
                        <div style="font-size:20px; font-weight:bold; color:#1a73e8;">${t.price} ‚Ç∏</div>
                        <div style="margin:10px 0; font-weight:600;">${t.title}</div>
                        <div style="font-size:12px; color:#666;">‚Ññ ${t.no} | –°—Ç–∞—Ç—É—Å: ${t.status}</div>
                    </div>
                `).join('');
                if(data.length === 0) resultsDiv.innerHTML = "–ù–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ.";
            } catch (e) {
                resultsDiv.innerHTML = "<p style='color:red'>Hata: Bot √ßalƒ±≈ümƒ±yor (CMD'yi kontrol edin).</p>";
            }
        }
    </script>
</body>
</html>
